<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard</title>
</head>

<body>

  <!-- ğŸ” ×—×¡×™××” ×× ×œ× ××’×™×¢×™× ×“×¨×š ×”×“×•××™×™×Ÿ ×”×¨×©××™ -->
  <script>
    if (location.hostname !== "dashboard.3144.info") {
      document.body.innerHTML = "";
      throw new Error("Blocked: invalid host");
    }
  </script>

  <h1>×“×©×‘×•×¨×“ ×‘×“×™×§×”</h1>

  <p>×”×›× ×¡×•×ª: <span id="revenue">×˜×•×¢×Ÿâ€¦</span></p>
  <p>××©×ª××©×™× ×¤×¢×™×œ×™×: <span id="users">×˜×•×¢×Ÿâ€¦</span></p>
  <p>×™×—×¡ ×”××¨×”: <span id="conversion">×˜×•×¢×Ÿâ€¦</span>%</p>
  <p>×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”: <span id="updated">×˜×•×¢×Ÿâ€¦</span></p>

  <pre id="status" style="white-space: pre-wrap; background:#f6f6f6; padding:10px;"></pre>

  <script>
    // ğŸ“„ ×§×¨×™××” ×œ× ×ª×•× ×™× ×××•×ª×• ×“×•××™×™×Ÿ (×××•×‘×˜×— ×¢"×™ Cloudflare)
    const URL = "/latest.json?v=" + Date.now();

    async function load() {
      const statusEl = document.getElementById("status");
      statusEl.textContent = "×˜×•×¢×Ÿ × ×ª×•× ×™× ×:\n" + URL + "\n\n";

      try {
        const res = await fetch(URL, { cache: "no-store" });
        statusEl.textContent += "HTTP Status: " + res.status + "\n";

        const text = await res.text();

        let data;
        try {
          data = JSON.parse(text);
        } catch {
          statusEl.textContent += "\nâŒ JSON ×œ× ×ª×§×™×Ÿ:\n" + text.slice(0, 300);
          return;
        }

        document.getElementById("revenue").innerText = data.revenue ?? "â€”";
        document.getElementById("users").innerText = data.activeUsers ?? "â€”";
        document.getElementById("conversion").innerText = data.conversionRate ?? "â€”";
        document.getElementById("updated").innerText = data.updatedAt ?? "â€”";

        statusEl.textContent += "\nâœ… ×¢×•×“×›×Ÿ ×‘×”×¦×œ×—×”";
      } catch (e) {
        statusEl.textContent += "\nâŒ ×©×’×™××ª ×¨×©×ª:\n" + e.message;
        console.error(e);
      }
    }

    load();
  </script>

</body>
</html>
